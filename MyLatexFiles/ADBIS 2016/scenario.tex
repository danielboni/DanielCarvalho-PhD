This section is devoted to describe the motivation scenario and challenges
concerning our data integration approach.
%

Let us assume the following scenario in the medical domain. 
Users are able to retrieve information about (1) patients that were infected by a disease; 
(2) regions in the Europe most infected by a disease; 
(3) patients' personal information; and 
(4) patients' dna information.
To perform these actions, four family of services are necessary: family \textbf{A} services that given a disease name, it retrieves the list of infected patients by the disease; family \textbf{B} services that given a disease name, it retrieves the list of cities most affected by the disease; family \textbf{C} services that given a patient id, it retrieves patients' personal information; and family \textbf{D} services that given a patient id, it retrieves patients' dna information. Assume that the doctor Marcel would like to study the type of people suffering of a particular disease. For instance, he needs to query the patients' personal information and patients' dna information from patients that were infected by flu. Presuming Marcel has at his disposal a cloud including a set of services from the families \textbf{A}, \textbf{B}, \textbf{C} and \textbf{D}. To achieve his needs Marcel can use the data services  as follows: He invokes service \textbf{S1} (family \textbf{A}) with the disease information then he gets the set of people infected by flu; then he invokes service \textbf{S2} (family \textbf{C}) with the obtained patients to retrieve their personal information; Then he invokes service \textbf{S3} (family \textbf{D}) with the obtained patients to retrieve their dna information. Then the results for the query is integrated and returned.

Depending on the amount of services in each family type, a lot of other service compositions could be done to answer Marcel's query. A large quantity of algorithms for this purpose have been developed, and all of them share the same problems: (1) producing rewritings when a big amount of services are available is extremely expensive; and (2) not always the quality of the rewriting (composition) produced is enough for meeting your needs.
Motivated by these problems, our approach proposes a new vision of data integration as follows.

Assuming the same medical scenario and the same family of data services.
Let us suppose Marcel would like to study the type of people suffering of a particular disease as before. However, in this new scenario, he is also capable to express his preferences while integrating services. For instance, he needs to query the patients' personal information and patients' dna information from patients that were infected by flu, using services with availability higher than 98\%, price per call less than 0.2\$ and total cost less than 2\$. Marcel has at his disposal a set of services from the families \textbf{A}, \textbf{B}, \textbf{C} and \textbf{D} geographically disposed on different cloud provides (configuring a multi-cloud environment). 
To achieve his needs Marcel can use the data services as before invoking one service from the family \textbf{A}, \textbf{C} and \textbf{D} in sequence. However, in this new configuration all the services involved must satisfy the user preferences expressed in the query. The selection and rewriting process is guided by the service level agreements (SLA) exported from different services. The user preferences are matched with the service quality aspects that are defined on its SLAs. 
This new vision of data integration brings new challenges such as: 
(1) the amount of services involved in a multi-cloud context is bigger than in a single cloud. Consequently, the number of services that can be used in the rewriting process and the number of rewriting produced is higher. Such environment calls for a better services selection process, in this case, guided by the SLAs and user preferences;
(2) How can the different SLAs associated to services and cloud provider can be integrated with the user preferences? There are different levels of SLAs: the one agreed between services and cloud providers; and the ones agreed between services and users. These SLAs should be integrated; and 
(3) How can a previous processed query be reused for a next query?

Here, it is important to highlight that this paper focus on the description and evaluation of the algorithm that rewrites queries in terms of services composition taking into account user preferences and service quality aspects expressed in SLA contracts. We are assuming that the extraction of quality aspects from SLAs is performed in a previous phase of our global data integration solution.
In the next section, the Rhone service-based algorithm is described and formalized.